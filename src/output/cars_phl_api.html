<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.plot.ly/plotly-2.8.3.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
        <link rel="stylesheet" href="src/templates/static/stylesheet.css">
</head>
<body class="container" onload="onPageLoad()">
    <div class="col">
        <header class="container-fluid mb-4 border-bottom border-secondary">
        <div>
    <h1> Mike </h1>
    <h3 class="text-muted"> Cars phl api </h3>
  </div>
        </header>
        <main class="container">
        
    <div class="row">
        
    <table class="table table-striped">
        <thead>
            <tr scope="span">
                <th>Yearly Data</th>
            </tr>
            <tr>
                <th scope="col" class="col-2 text-left">Crash Year</th>
                <th scope="col" class="col text-right">Fatal Crashes</th>
                <th scope="col" class="col text-right">Bike Crashes</th>
                <th scope="col" class="col text-right">Injuries</th>
           </tr>
        </thead>
        <tbody>
            
              <tr>
                <td class="text-left">2011</td>
                <td class="text-right">84</td>
                <td class="text-right">476</td>
                <td class="text-right">11,099</td>
              </tr>
            
              <tr>
                <td class="text-left">2012</td>
                <td class="text-right">107</td>
                <td class="text-right">509</td>
                <td class="text-right">12,228</td>
              </tr>
            
              <tr>
                <td class="text-left">2013</td>
                <td class="text-right">91</td>
                <td class="text-right">539</td>
                <td class="text-right">11,710</td>
              </tr>
            
              <tr>
                <td class="text-left">2014</td>
                <td class="text-right">97</td>
                <td class="text-right">549</td>
                <td class="text-right">11,076</td>
              </tr>
            
              <tr>
                <td class="text-left">2015</td>
                <td class="text-right">92</td>
                <td class="text-right">549</td>
                <td class="text-right">11,950</td>
              </tr>
            
              <tr>
                <td class="text-left">2016</td>
                <td class="text-right">101</td>
                <td class="text-right">483</td>
                <td class="text-right">12,625</td>
              </tr>
            
              <tr>
                <td class="text-left">2017</td>
                <td class="text-right">94</td>
                <td class="text-right">432</td>
                <td class="text-right">11,224</td>
              </tr>
            
        </tbody>
    </table>

    </div>
    <div class="row">
        <div class="col-md-4">
            
    <aside>
        <h3>Data from 2011 - 2017</h3>
        <p>This is data from Open Data PHL, for car and bike accidents
        between 2011 and 2017. I could include some other info as well, but I'm
        just writing to take up space at the moment.</p>
    </aside>

        </div>
        <div class="col-md-8">
            
    <div id="graphDiv" style="min-width:800px"></div>

        </div>
    </div>
</br>

        </main>
        <footer class="container-fluid mt-1 border-top border-secondary">
        <div class="row">
    <div class="col">
      <a class="text-muted"> Cars phl api </a>
    </div>
    <div class="col">
      <a class="text-muted"> All Rights Reserved </a>
    </div>
  </div>
        </footer>
    </div>
    <script type="text/javascript">
        
    function prop_to_array(rows, prop, fn=(a)=>a) {
        return rows.map((r) => fn(r[prop]));
    }
    function map_data(rows) {
        bike_data = {
            x: prop_to_array(rows, "crash_year"),
            y: prop_to_array(rows, "bike_crash"),
            name: "Bike Crashes",
            mode: "markers",
            type: "scatter",
            marker: {
                size: prop_to_array(rows, "fatal"),
                opacity: 0.8
            }
        };
        injury_data = {
            x: prop_to_array(rows, "crash_year"),
            y: prop_to_array(rows, "injury"), 
            name: "Injuries",
            mode: "markers",
            type: "scatter",
            marker: {
                size: prop_to_array(rows, "fatal"),
                opacity: 0.6,
                color: "green"
            }
        };
        return [bike_data, injury_data];
    }
    function onPageLoad(){
        let graphData = [{"bike_crash": 476, "crash_year": 2011, "fatal": 84, "injury": 11099}, {"bike_crash": 549, "crash_year": 2015, "fatal": 92, "injury": 11950}, {"bike_crash": 549, "crash_year": 2014, "fatal": 97, "injury": 11076}, {"bike_crash": 432, "crash_year": 2017, "fatal": 94, "injury": 11224}, {"bike_crash": 483, "crash_year": 2016, "fatal": 101, "injury": 12625}, {"bike_crash": 509, "crash_year": 2012, "fatal": 107, "injury": 12228}, {"bike_crash": 539, "crash_year": 2013, "fatal": 91, "injury": 11710}];
        Plotly.newPlot("graphDiv",
                        map_data(graphData),
                        {displayModeBar:false});
    }

    </script>
</body>
</html>
